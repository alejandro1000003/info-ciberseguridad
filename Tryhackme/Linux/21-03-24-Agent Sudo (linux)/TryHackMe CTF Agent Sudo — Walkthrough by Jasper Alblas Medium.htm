<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this file,
   - You can obtain one at http://mozilla.org/MPL/2.0/. -->
<!DOCTYPE html>
<html platform="win" lang="es-ES" dir="ltr"><head>
    <title id="reader-title">TryHackMe CTF: Agent Sudo — Walkthrough | by Jasper Alblas | Medium</title>
    <meta http-equiv="Content-Security-Policy" content="default-src chrome:; img-src data: *; media-src *; object-src 'none'">
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <meta name="viewport" content="width=device-width; user-scalable=0">
    <link rel="stylesheet" href="chrome://global/skin/aboutReader.css" type="text/css">
    <link rel="localization" href="toolkit/about/aboutReader.ftl">
    <link rel="localization" href="toolkit/branding/brandings.ftl">
  <link rel="stylesheet" href="chrome://global/skin/narrate.css"><link rel="shortcut icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"></head>

  <body class="light sans-serif loaded" style="--font-size: 20px; --content-width: 30em;">
    <div class="top-anchor"></div>

    <div id="toolbar" class="toolbar-container">
      <div class="toolbar reader-toolbar">
        <div class="reader-controls" articledir="ltr">
          <button class="close-button toolbar-button" aria-labelledby="toolbar-close" data-telemetry-id="reader-close">
            <span class="hover-label" id="toolbar-close" data-l10n-id="about-reader-toolbar-close">Cerrar vista de lectura</span>
          </button>
          <ul class="dropdown style-dropdown">
            <li>
              <button class="dropdown-toggle toolbar-button style-button" aria-labelledby="toolbar-type-controls" data-telemetry-id="reader-type-controls">
                <span class="hover-label" id="toolbar-type-controls" data-l10n-id="about-reader-toolbar-type-controls">Controles de tipografía</span>
              </button>
            </li>
            <li class="dropdown-popup">
              <div class="dropdown-arrow"></div>
              <div class="font-type-buttons radiorow"><input id="radio-itemsans-serif-button" type="radio" class="radio-button" name="font-type" checked="checked"><label for="radio-itemsans-serif-button" class="sans-serif-button" data-l10n-id="about-reader-font-type-sans-serif" checked="true">Sans-serif</label><input id="radio-itemserif-button" type="radio" class="radio-button" name="font-type"><label for="radio-itemserif-button" class="serif-button" data-l10n-id="about-reader-font-type-serif">Serif</label></div>
              <div class="font-size-buttons buttonrow">
                <button class="minus-button" data-l10n-id="about-reader-toolbar-minus" title="Disminuir tamaño de fuente"></button>
                <span class="font-size-value">5</span>
                <button class="plus-button" data-l10n-id="about-reader-toolbar-plus" title="Aumentar tamaño de fuente"></button>
              </div>
              <div class="content-width-buttons buttonrow">
                <button class="content-width-minus-button" data-l10n-id="about-reader-toolbar-contentwidthminus" title="Disminuir anchura del contenido"></button>
                <span class="content-width-value">3</span>
                <button class="content-width-plus-button" data-l10n-id="about-reader-toolbar-contentwidthplus" title="Aumentar anchura del contenido"></button>
              </div>
              <div class="line-height-buttons buttonrow">
                <button class="line-height-minus-button" data-l10n-id="about-reader-toolbar-lineheightminus" title="Disminuir longitud de línea"></button>
                <span class="line-height-value">4</span>
                <button class="line-height-plus-button" data-l10n-id="about-reader-toolbar-lineheightplus" title="Aumentar longitud de línea"></button>
              </div>
              <div class="color-scheme-buttons radiorow"><input id="radio-itemlight-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemlight-button" class="light-button" data-l10n-id="about-reader-color-scheme-light" title="Esquema de color claro">Claro</label><input id="radio-itemdark-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemdark-button" class="dark-button" data-l10n-id="about-reader-color-scheme-dark" title="Esquema de color oscuro">Oscuro</label><input id="radio-itemsepia-button" type="radio" class="radio-button" name="color-scheme"><label for="radio-itemsepia-button" class="sepia-button" data-l10n-id="about-reader-color-scheme-sepia" title="Esquema de color sepia">Sepia</label><input id="radio-itemauto-button" type="radio" class="radio-button" name="color-scheme" checked="checked"><label for="radio-itemauto-button" class="auto-button" data-l10n-id="about-reader-color-scheme-auto" checked="true" title="Esquema de color automático">Auto</label></div>
            </li>
          </ul>
        <ul class="dropdown narrate-dropdown"><li><button class="dropdown-toggle toolbar-button narrate-toggle" data-telemetry-id="reader-listen" aria-label="Escuchar (N)"><span class="hover-label">Escuchar (N)</span></button></li><li class="dropdown-popup"><div class="narrate-row narrate-control"><button class="narrate-skip-previous" disabled="disabled" title="Atrás"></button><button class="narrate-start-stop" title="Iniciar (N)"></button><button class="narrate-skip-next" disabled="disabled" title="Siguiente"></button></div><div class="narrate-row narrate-rate"><input class="narrate-rate-input" value="0" step="5" max="100" min="-100" type="range" title="Velocidad"></div><div class="narrate-row narrate-voices"><div class="voiceselect voice-select"><button class="select-toggle" aria-controls="voice-options">
      <span class="label">Voz:</span> <span class="current-voice">Por omisión</span>
    </button>
    <div class="options" id="voice-options" role="listbox"><button data-value="automatic" class="option selected" tabindex="-1" role="option" aria-selected="true">Por omisión</button><button data-value="urn:moz-tts:sapi:Microsoft Zira Desktop - English (United States)?en-US" class="option" tabindex="-1" role="option">Microsoft Zira Desktop - English (United States)</button></div></div></div><div class="dropdown-arrow"></div></li></ul><button data-buttonid="pocket-button" data-telemetry-id="reader-save-to-pocket" class="toolbar-button pocket-button" aria-labelledby="label-pocket-button" style="background-image: url(&quot;chrome://global/skin/icons/pocket.svg&quot;);"><span class="hover-label" id="label-pocket-button" data-l10n-id="about-reader-toolbar-savetopocket">Guardar en Pocket</span></button></div>
      </div>
    </div>

    <div class="container" style="--line-height: 1.6em;" lang="en" dir="ltr">
      <div class="header reader-header reader-show-element">
        <a class="domain reader-domain" href="https://medium.com/@JAlblas/tryhackme-agent-sudo-walkthrough-933b977fffb">medium.com</a>
        <div class="domain-border"></div>
        <h1 class="reader-title">TryHackMe CTF: Agent Sudo — Walkthrough - Jasper Alblas - Medium</h1>
        <div class="credits reader-credits">Jasper Alblas</div>
        <div class="meta-data">
          <div class="reader-estimated-time" data-l10n-args="{&quot;range&quot;:&quot;5-7&quot;,&quot;rangePlural&quot;:&quot;other&quot;}" data-l10n-id="about-reader-estimated-read-time" dir="ltr">5-7 minutos</div>
        </div>
      </div>

      <hr>

      <div class="content">
        <div class="moz-reader-content reader-show-element"><div id="readability-page-1" class="page"><div><h2 id="5b2d" data-selectable-paragraph="">Task 2 (Enumerate)</h2><p id="7a95" data-selectable-paragraph="">Enumerate the machine and get all the important information</p><h2 id="1526" data-selectable-paragraph="">Questions</h2><p id="11d1" data-selectable-paragraph=""><strong>How many open ports?</strong></p><p id="6551" data-selectable-paragraph="">I
 first tried running nmap with the -sn flag. This did not return any 
results, as this is likely due to the machine not responding to pings. 
Therefore I switched to using the <strong>-Pn</strong> flag which treats all hosts as online.</p><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="193" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20dXTa5Oe1ZvPOSZM8OSz7Eg.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Scanning for services</figcaption></figure><p id="cf0f" data-selectable-paragraph="">Let’s get more info on them by using the <strong>-A</strong> flag.</p><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="376" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20QlOR6f89f_RhRP1suytKEA.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Scanning for more info on the 3 services</figcaption></figure><p id="8c8a" data-selectable-paragraph="">Three ports are open.</p><blockquote><p id="6564" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>3</em></p></blockquote><p id="9a60" data-selectable-paragraph=""><strong>How you redirect yourself to a secret page?</strong></p><p id="87b0" data-selectable-paragraph="">We can a service running on http, so this is a website we can visit in our browser:</p><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="526" height="252" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%202tDjTSZ0AWmZUKys_TkNjg.png" class="moz-reader-block-img"></picture></div><figcaption data-selectable-paragraph="">Visiting the webpage</figcaption></figure><p id="e993" data-selectable-paragraph="">Well, we get a hint here. User-agent is a header we can set.</p><blockquote><p id="2392" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>user-agent</em></p></blockquote><p id="2372" data-selectable-paragraph=""><strong>What is the agent name?</strong></p><p id="7568" data-selectable-paragraph="">We can use Burp Suite to intercept the request and edit the User-Agent header before sending it forward.</p><p id="934a" data-selectable-paragraph="">I thought it would be smart to use <strong>R</strong> as User-Agent as that is the name written on the main page. This gives us the following:</p><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="410" height="173" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20b_v5z4h-AV-8qete2F6zOg.png" class="moz-reader-block-img"></picture></div></figure><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="166" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20zUmWc_vn4lULcz-VX_EA0Q.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div></figure><p id="b025" data-selectable-paragraph="">This
 is actually a hint. Since the head agent is called R, and he mentions 
25 other employees, my assumption was that all agents are called by a 
letter.</p><p id="0446" data-selectable-paragraph="">I first tried adding A as user-agent, followed by B. This did nothing. But adding C redirects us to the following page:</p><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="208" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20aFyCXVAmO-asR_s1EQvymQ.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Finding the secret page</figcaption></figure><blockquote><p id="9ac4" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>Chris</em></p></blockquote></div><div><h2 id="747c" data-selectable-paragraph="">Task 3 (Hash cracking and brute-force)</h2><p id="4cf9" data-selectable-paragraph="">Done enumerate the machine? Time to brute your way out.</p><h2 id="a819" data-selectable-paragraph="">Questions</h2><p id="dc8c" data-selectable-paragraph=""><strong>FTP password</strong></p><p id="788b" data-selectable-paragraph="">We
 know that the username of the agent is either C or chris. Let’s try 
chris first as C is probably to short of a username. We will use hydra 
to crack the password, although we could probably also use a Metasploit 
module (ftp_login) or other tools.</p><pre><span id="e91e" data-selectable-paragraph="">hydra -l chris -P /usr/share/wordlists/rockyou.txt ftp://&lt;target ip&gt;</span></pre><p id="7b56" data-selectable-paragraph="">This quickly gave us the password:</p><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="631" height="77" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20gvQ26cOWMZVD3wQmHpQj_g.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Cracking the ftp password with hydra</figcaption></figure><blockquote><p id="70c7" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>crystal</em></p></blockquote><p id="ca36" data-selectable-paragraph=""><strong>Zip file password</strong></p><p id="0707" data-selectable-paragraph="">Let’s enter the FTP with our newly aquired credentials:</p><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="647" height="306" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%209q5qXojBtlGFVXMeEJ8f8g.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Logging into the FTP service</figcaption></figure><p id="d5cb" data-selectable-paragraph="">You can use <strong><em>mget *</em></strong> to download all files.</p><p id="40ae" data-selectable-paragraph="">Now we can read the txt file:</p><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="98" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%203XXnWwTlN8Rh3PWaaUQ7UQ.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Reading the To_agentJ.txt file</figcaption></figure><p id="75e7" data-selectable-paragraph="">It points us to a fake and a real picture. The fake picture hides the login password for Agent J.</p><p id="c67d" data-selectable-paragraph="">There
 are different terminal commands to investigate the images. We can use 
file, but nothing seems strange in its ouput. Another possibility is 
using exiftool, which helps us to read meta information:</p><pre><span id="ae8f" data-selectable-paragraph="">exiftool cutie.png</span></pre><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="397" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20lJmqWtY7v-VoAseflEGmTg.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Running exiftool</figcaption></figure><p id="2ebd" data-selectable-paragraph="">It mentions a warning: Trailer data after PNG IEND chunk.</p><p id="f197" data-selectable-paragraph="">Let’s dump the file to hex format by using xxd.</p><pre><span id="6d9b" data-selectable-paragraph="">xxd cutie.png</span></pre><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="650" height="558" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20iialL7NxECpq1nVb9IAUCA.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Running xxd</figcaption></figure><p id="9d3b" data-selectable-paragraph="">Hmm..some interesting text. This can also be seen when running <strong>strings cutie.png</strong>.</p><p id="14a3" data-selectable-paragraph="">The
 last tool we can use is binwalk. Binwalk is a tool that allows you to 
search binary images for embedded files and executable code. Let’s try 
this out:</p><pre><span id="0e46" data-selectable-paragraph="">binwalk cutie.png</span></pre><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="149" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20xCn8qOaH1thtlBtEti9VdA.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Running binwalk</figcaption></figure><p id="6bc1" data-selectable-paragraph="">There we have it! We have a hidden zip file hidden in the image, which hides a txt file called To_agentR.txt.</p><p id="ca21" data-selectable-paragraph="">We can extract the file by running the same command, together with the -e flag.</p><pre><span id="0d98" data-selectable-paragraph="">binwalk -e cutie.png</span></pre><p id="1ed2" data-selectable-paragraph="">We can find the files in the _cutie.png.extracted folder.</p><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="660" height="147" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20RvtSAGzTOWb9V4izQUGEjg.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Looking at the extracted zip file contents</figcaption></figure><p id="6d1b" data-selectable-paragraph="">We can use the zip2john tool to convert the zip to a format suitable for john.</p><pre><span id="0007" data-selectable-paragraph="">zip2john 8702.zip &gt; hash.txt</span></pre><p id="3af6" data-selectable-paragraph="">Now we can crack it with john:</p><pre><span id="2a27" data-selectable-paragraph="">john hash.txt</span></pre><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="232" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20VSwie5jtonMAtrgSK1VxUA.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Cracking the zip file hash with john</figcaption></figure><p id="c11d" data-selectable-paragraph="">We got the password. It took quite a few steps to get here. Good job :)</p><blockquote><p id="0344" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>alien</em></p></blockquote><p id="ece9" data-selectable-paragraph=""><strong>steg password</strong></p><p id="0e4a" data-selectable-paragraph="">Now we can open the zip file and read the txt file. We can do this with the following command:</p><pre><span id="4aa2" data-selectable-paragraph="">7z e 8702.zip</span></pre><p id="3a99" data-selectable-paragraph="">This gives us the file, which we can read with <strong>cat</strong>.</p><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="570" height="131" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20pMkNnLzpZ29pC7sH3n869g.png" class="moz-reader-block-img"></picture></div><figcaption data-selectable-paragraph="">Reading the To_agentR.txt file</figcaption></figure><p id="4b91" data-selectable-paragraph="">More clues. QXJlYTUx looks out of the ordinary. It looks encoded somehow.</p><p id="3692" data-selectable-paragraph="">We can try decoding it here:</p><p id="cb1f" data-selectable-paragraph="">This gives us area51.</p><blockquote><p id="e04a" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>area51</em></p></blockquote><p id="0124" data-selectable-paragraph=""><strong>Who is the other agent (in full name)?</strong></p><p id="f48a" data-selectable-paragraph="">Now,
 this one was a bit trickier to be honest. We need to use steghide 
together with a passphrase to find hidden files in image/audio files.</p><p id="9191" data-selectable-paragraph="">Run:</p><pre><span id="bddd" data-selectable-paragraph="">steghide extract -sf cute-alien.jpg</span></pre><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="228" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%2061wRXwX7dOmcbBCgcQlinA.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Finding the secret message with steghide</figcaption></figure><p id="6ed2" data-selectable-paragraph="">We find a message, together with a username and password!</p><blockquote><p id="49ad" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>james</em></p></blockquote><p id="db96" data-selectable-paragraph=""><strong>SSH password</strong></p><blockquote><p id="9a01" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>hackerrules!</em></p></blockquote></div><div><h2 id="60a4" data-selectable-paragraph="">Task 4 (Capture the user flag)</h2><p id="4913" data-selectable-paragraph="">You know the drill.</p><h2 id="9fe3" data-selectable-paragraph="">Questions</h2><p id="9ccd" data-selectable-paragraph=""><strong>What is the user flag?</strong></p><p id="bacb" data-selectable-paragraph="">This one is easy. Simply login to the SSH service with the username and password discover in the previous step:</p><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="509" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20poIMIIumn12cY76Q6qHMew.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Logging into the SSH service</figcaption></figure><blockquote><p id="a604" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>b03d975e8c92a7c04146cfa7a5a313c7</em></p></blockquote><p id="613e" data-selectable-paragraph=""><strong>What is the incident of the photo called?</strong></p><p id="70f8" data-selectable-paragraph="">Exit the SSH service, and copy the jpg file from the SSH service to your system with the following command:</p><pre><span id="b61c" data-selectable-paragraph="">sudo scp james@&lt;target ip&gt;:Alien_autospy.jpg ~/</span></pre><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="108" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20Rf5qW8eYkPW7R6nHxCLrrA.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Copying the image to our system</figcaption></figure><p id="c9d7" data-selectable-paragraph="">Now it is time to do a reverse image search at <a href="https://images.google.com/" rel="noopener ugc nofollow" target="_blank">https://images.google.com/</a>.</p><figure><div><picture><source type="image/webp"><source data-testid="og"><img alt="" width="686" height="537" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20MsLuqAWVlojg3RX9udE9nQ.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Reverse image searching</figcaption></figure><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="179" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20dlKDIvGFwz-43r0bP3kSvw.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Article using the image</figcaption></figure><blockquote><p id="c659" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>Roswell alien autopsy</em></p></blockquote></div><div><h2 id="ad41" data-selectable-paragraph="">Task 5 (Privilege escalation)</h2><p id="1398" data-selectable-paragraph="">Enough with the extraordinary stuff? Time to get real.</p><h2 id="5239" data-selectable-paragraph="">Questions</h2><p id="0d73" data-selectable-paragraph=""><strong>CVE number for the escalation (Format: CVE-xxxx-xxxx)</strong></p><p id="a2d5" data-selectable-paragraph="">Log back in on the SSH service with james. Try and see what privileges james has by running <strong><em>sudo -l</em></strong>.</p><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="140" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%20tBBgbT_lfhlTBon9rvym7g.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Checking out james’ privileges</figcaption></figure><p id="aea3" data-selectable-paragraph=""><strong><em>(ALL, !root) /bin/bash </em></strong>sounds interesting!</p><p id="2ed1" data-selectable-paragraph="">Let’s see if we can find out more by googling. I came across the following page on exploitdb:</p><p id="c8aa" data-selectable-paragraph="">This has the following CVE number: CVE-2019–14287. It allows us to get root access by running:</p><pre><span id="9347" data-selectable-paragraph="">sudo -u#-1 /bin/bash</span></pre><blockquote><p id="2512" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>CVE-2019–14287</em></p></blockquote><p id="6e40" data-selectable-paragraph=""><strong>What is the root flag?</strong></p><p id="5fed" data-selectable-paragraph="">Gain root access by entering the above command. Then change directory to the root and find the root.txt file.</p><figure><div role="button" tabindex="0"><picture><source type="image/webp"><source data-testid="og"><img alt="" width="700" height="213" role="presentation" src="TryHackMe%20CTF%20Agent%20Sudo%20%E2%80%94%20Walkthrough%20by%20Jasper%20Alblas%20Medium_files/1%204RRZVjKy6p3iEXXn6T8VUQ.png" class="moz-reader-block-img" moz-reader-center="true"></picture></div><figcaption data-selectable-paragraph="">Reading the root flag</figcaption></figure><blockquote><p id="dcfb" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>b53a02f55b57d4439e3341834d70c062</em></p></blockquote><p id="81b4" data-selectable-paragraph=""><strong>(Bonus) Who is Agent R?</strong></p><blockquote><p id="8805" data-selectable-paragraph=""><strong><em>Answer</em></strong>: <em>DesKel</em></p></blockquote><p id="0cbf" data-selectable-paragraph="">We are done! I hope you learned a lot by following along. Give me a clap or two if you benefited from my article! :)</p></div></div></div>
      </div>

      <div>
        <div class="reader-message"></div>
      </div>
      <div aria-owns="toolbar"></div>
    </div>
  

</body></html>